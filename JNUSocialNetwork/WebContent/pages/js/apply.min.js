function SimpleLeague(){"use strict";this.id="",this.imgsrc="",this.title="",this.intro="",this.departments=[]}!function(t){"use strict";function o(){t(".apply-btn").click(function(){a(t(this).data("id"))})}function r(e,n,i,o){var r="/app/community/fetchByType/"+e+"/"+n+"/"+i;t.getJSON(r,o)}function a(e){var o="/app/community/getDepartment/"+e;t.getJSON(o,function(t){console.log(t),i=t;var e=document.getElementById("intent_dept1");e.options.length=0;for(var n in i)e.options[n]=new Option(i[n],i[n]);e.options[0].selected=!0,s()})}function s(){var t=document.getElementById("intent_dept1"),e=document.getElementById("intent_dept2");e.options.length=0;for(var n in i)e.options[n]=new Option(i[n],i[n]);e.options.remove(t.selectedIndex)}function c(t){for(var e in t)t[e].available&&n.push(t[e]);window.innerWidth>=992?l(n,10):l(n,6)}function l(t,e){var n=t.length;n>e&&(n=e);for(var i=0;n>i;i++){var r=new SimpleLeague;r.id=t[i].ID,r.title=t[i].attributes.name,r.intro=t[i].attributes.introduct,r.imgsrc=JSON.parse(t[i].attributes.communityCard).src,d(r)}o()}function d(e){var n=t("#template").clone();n.removeAttr("id"),n.find(".apply-btn").data("id",e.id),n.find(".league-photo").attr("src",e.imgsrc),n.find(".league-title").text(e.title),n.find(".league-intro").text(e.intro),t("#league-list").append(n)}function u(t){t.fadeIn(500),setTimeout(function(){t.fadeOut(500)},4e3)}var e=t(window).height(),n=[],i=[];t(document).ready(function(){r("SCHOOLUNION",0,30,c)}),t(window).scroll(function(){var i=t(document.body).height(),r=t(window).scrollTop(),a=(i-e-r)/e;.1>a&&t("#league-list").children().size()<n.length&&(l(n.slice(t("#league-list").children().size()),3),o())}),t("#confirm-btn").click(function(){var e={};e.name=t("#studentID").val(),e.password=t("#password").val(),e.telnum=t("#telNum").val(),e.wish1=t("#intent_dept1").find("option:selected").val(),e.wish2=t("#intent_dept2").find("option:selected").val();var n={type:"POST",data:e,error:function(e,n,i){console.log("post error!"+i),u(t("#errorAlert"))},success:function(){console.log("post success"),u(t("#successAlert"))},headers:{"Content-Type":"application/json;charset=utf-8"}};t.ajax("/app/user/registerCandC",n),t("#applyModal").modal("hide")}),t("#intent_dept1").change(function(){s()})}(jQuery);