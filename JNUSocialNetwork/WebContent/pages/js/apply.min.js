function SimpleLeague(){"use strict";this.id="",this.imgsrc="",this.title="",this.intro="",this.departments=[]}!function(t){"use strict";function o(){t("#league-list").delegate(".apply-btn","click",function(){a(t(this).data("id"))})}function r(e,n,i,o){var r="/app/community/fetchByType/"+e+"/"+n+"/"+i;t.getJSON(r,o)}function a(e){var o="/app/community/getDepartment/"+e;t.getJSON(o,function(t){console.log(t),i=t;var e=document.getElementById("intent_dept1");e.options.length=0;for(var n in i)e.options[n]=new Option(i[n],i[n]);e.options[0].selected=!0,s()})}function s(){var t=document.getElementById("intent_dept1"),e=document.getElementById("intent_dept2");e.options.length=0;for(var n in i)e.options[n]=new Option(i[n],i[n]);e.options.remove(t.selectedIndex)}function l(t){var e=[1411301318703,1411090991902,1411555413859,1411397204271,1411055191107,1411054407457,1411522941400,1411390027993];for(var i in e)for(var o in t)if(e[i]===t[o].ID){n.push(t[o]);break}window.innerWidth>=992?c(n,10):c(n,6)}function c(t,e){var n=t.length;n>e&&(n=e);for(var i=0;n>i;i++){var o=new SimpleLeague;o.id=t[i].ID,o.title=t[i].attributes.name,o.intro=t[i].attributes.introduct,o.imgsrc=JSON.parse(t[i].attributes.communityCard).src,d(o)}}function d(e){var n=t("#template").clone();n.removeAttr("id"),n.find(".apply-btn").data("id",e.id),n.find(".league-photo").attr("src",e.imgsrc),n.find(".league-title").text(e.title),n.find(".league-intro").text(e.intro),t("#league-list").append(n)}function u(t){t.fadeIn(500),setTimeout(function(){t.fadeOut(500)},4e3)}var e=t(window).height(),n=[],i=[];t(document).ready(function(){r("OFFICIAL",0,30,l),o()}),t(window).scroll(function(){var i=t(document.body).height(),o=t(window).scrollTop(),r=(i-e-o)/e;.1>r&&t("#league-list").children().size()<n.length&&c(n.slice(t("#league-list").children().size()),3)}),t("#confirm-btn").click(function(){var e={};e.name=t("#studentID").val(),e.password=t("#password").val(),e.telnum=t("#telNum").val(),e.wish1=t("#intent_dept1").find("option:selected").val(),e.wish2=t("#intent_dept2").find("option:selected").val();var n={type:"POST",data:JSON.stringify(e),error:function(e,n,i){console.log("post error!"+i),u(t("#errorAlert"))},success:function(){console.log("post success"),u(t("#successAlert"))},headers:{"Content-Type":"application/json;charset=utf-8"}};t.ajax("/app/user/registerCandC",n),t("#applyModal").modal("hide")}),t("#intent_dept1").change(function(){s()})}(jQuery),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){null==e?e=0:0>e&&(e=Math.max(0,this.length+e));for(var n=e,i=this.length;i>n;n++)if(this[n]===t)return n;return-1});